<script>
    const GOOGLE_URL = "SUA_NOVA_URL_AQUI"; 

    async function finish(m) {
        const dateStr = new Date().toLocaleString('pt-BR');
        let payload;

        if (m === 'CORRIDA') {
            const dist = document.getElementById('run-dist').value + " KM";
            payload = { date: dateStr, type: m, data: dist };
        } else {
            // Envia apenas Nome, Séries e Reps
            const details = state.routines[activeT].map(ex => ({
                name: ex.n,
                setsDone: completed[ex.n] ? completed[ex.n].filter(s => s).length : 0,
                reps: ex.r
            }));
            payload = { date: dateStr, type: m, details: details };
        }

        // Histórico local
        state.history.unshift({date: dateStr, type: m, data: m === 'CORRIDA' ? payload.data : "Treino enviado"});
        localStorage.setItem('workoutV21', JSON.stringify(state));

        await fetch(GOOGLE_URL, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify(payload) 
        });

        alert("Dados salvos por coluna!");
        location.reload();
    }
</script>
